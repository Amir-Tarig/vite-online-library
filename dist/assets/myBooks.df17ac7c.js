import"./modulepreload-polyfill.b7f2da20.js";import{initializeApp as e}from"https://www.gstatic.com/firebasejs/9.0.2/firebase-app.js";import{getAuth as t,signOut as a}from"https://www.gstatic.com/firebasejs/9.0.2/firebase-auth.js";import{getFirestore as o,query as d,collection as n,onSnapshot as s,doc as r,updateDoc as c,addDoc as i,deleteDoc as u}from"https://www.gstatic.com/firebasejs/9.0.2/firebase-firestore.js";var l="/assets/Untitled.af0380b1.png";const m=document.createElement("div");m.classList.add("bookContainer");const p=e(firebaseConfig),f=o(p),b=t(p);b.onAuthStateChanged((e=>{e&&(function(e){if(e){const t=document.querySelector(".userImg"),a=document.querySelector(".userName");t.setAttribute("src",e.photoURL),a.textContent=e.displayName}else userImg.src="",userImg.style.background="white"}(e),async function(e){let t=[],a=[];const o=document.querySelector(".bookNumber"),i=d(n(f,`${e.uid}`));s(i,(d=>{m.innerHTML="",t=[],a=[],d.forEach((e=>{t.push(e.data()),a.push(e.id)})),o.textContent=t.length,function(e,t,a){e.map(((e,o)=>{const d=document.createElement("div");let n=document.createElement("img");const s=document.createElement("h3"),r=document.createElement("p"),c=document.createElement("button");d.classList.add("book"),n.classList.add("bookCover"),s.classList.add("bookTitle"),r.classList.add("deleteBtn"),c.classList.add("readBtn"),n.src=e.image?e.image:"",s.textContent=e.title,r.textContent="x",r.setAttribute("data-bookId",t[o]),r.setAttribute("data-userId",a),c.textContent=e.read?"Read":"Not Read",c.setAttribute("data-bookId",t[o]),c.setAttribute("data-userId",a),c.setAttribute("data-state",e.read),d.appendChild(n),d.appendChild(s),d.appendChild(r),d.appendChild(c),m.appendChild(d)})),document.body.appendChild(m);const o=document.querySelectorAll(".readBtn"),d=document.querySelectorAll(".deleteBtn");n=o,n.forEach((e=>{e.addEventListener("click",(async()=>{if(console.log(typeof e.dataset.state),"false"===e.dataset.state){const t=r(f,`${e.dataset.userid}`,`${e.dataset.bookid}`);await c(t,{read:!0})}else{const t=r(f,`${e.dataset.userid}`,`${e.dataset.bookid}`);await c(t,{read:!1})}}))})),function(e){e.forEach((e=>{e.addEventListener("click",(async function(e){await u(r(f,`${e.target.dataset.userid}`,`${e.target.dataset.bookid}`))}))}))}(d);var n}(t,a,e.uid)}))}(e),function(e){const t=document.querySelector("#BookTitle"),a=document.querySelector("#BookAuthor"),o=document.querySelector("#totalPages"),d=document.querySelector("#disc"),s=document.querySelector("#read");async function r(){try{await i(n(f,`${e.uid}`),{title:t.value,categories:"unknown",author:a.value,description:d.value,pages:o.value,image:l,read:s.checked});t.value="",a.value="",d.value="",o.value=0,s.checked=!1}catch(r){console.error("Error adding document: ",r)}}document.querySelector("#form").addEventListener("submit",(async e=>{e.preventDefault(),await r()}))}(e))}));const h=document.querySelector(".sign-out");document.querySelector(".redirect"),h.addEventListener("click",(()=>{window.location.replace("../index.html"),a(b).then((()=>{console.log("sgined-out")})).catch((e=>{console.log(e.message)}))}));
