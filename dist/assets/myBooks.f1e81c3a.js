import"./modulepreload-polyfill.b7f2da20.js";import{initializeApp as e}from"https://www.gstatic.com/firebasejs/9.0.2/firebase-app.js";import{getAuth as t,signOut as o}from"https://www.gstatic.com/firebasejs/9.0.2/firebase-auth.js";import{getFirestore as a,query as n,collection as s,onSnapshot as d,doc as r,updateDoc as c,addDoc as i,deleteDoc as u}from"https://www.gstatic.com/firebasejs/9.0.2/firebase-firestore.js";var l="/assets/Untitled.af0380b1.png";const m=document.createElement("div");m.classList.add("bookContainer");const p=e(firebaseConfig),f=a(p),g=t(p);g.onAuthStateChanged((e=>{e&&(function(e){if(e){const t=document.querySelector(".userImg"),o=document.querySelector(".userName");t.setAttribute("src",e.photoURL),o.textContent=e.displayName}else userImg.src="",userImg.style.background="white"}(e),async function(e){let t=[],o=[];const a=document.querySelector(".bookNumber"),i=n(s(f,`${e.uid}`));d(i,(n=>{m.innerHTML="",t=[],o=[],n.forEach((e=>{t.push(e.data()),o.push(e.id)})),a.textContent=t.length,function(e,t,o){e.map(((e,a)=>{const n=document.createElement("div");let s=document.createElement("img");const d=document.createElement("h3"),r=document.createElement("p"),c=document.createElement("button");n.classList.add("book"),s.classList.add("bookCover"),d.classList.add("bookTitle"),r.classList.add("deleteBtn"),c.classList.add("readBtn"),s.src=e.image?e.image:"",d.textContent=e.title,r.textContent="x",r.setAttribute("data-bookId",t[a]),r.setAttribute("data-userId",o),c.textContent=e.read?"Read":"Not Read",c.setAttribute("data-bookId",t[a]),c.setAttribute("data-userId",o),c.setAttribute("data-state",e.read),n.appendChild(s),n.appendChild(d),n.appendChild(r),n.appendChild(c),m.appendChild(n)})),document.body.appendChild(m);const a=document.querySelectorAll(".readBtn"),n=document.querySelectorAll(".deleteBtn");s=a,s.forEach((e=>{e.addEventListener("click",(async()=>{if(console.log(typeof e.dataset.state),"false"===e.dataset.state){const t=r(f,`${e.dataset.userid}`,`${e.dataset.bookid}`);await c(t,{read:!0})}else{const t=r(f,`${e.dataset.userid}`,`${e.dataset.bookid}`);await c(t,{read:!1})}}))})),function(e){e.forEach((e=>{e.addEventListener("click",(async function(e){await u(r(f,`${e.target.dataset.userid}`,`${e.target.dataset.bookid}`))}))}))}(n);var s}(t,o,e.uid)}))}(e),function(e){const t=document.querySelector("#BookTitle"),o=document.querySelector("#BookAuthor"),a=document.querySelector("#totalPages"),n=document.querySelector("#disc"),d=document.querySelector("#read");async function r(){try{let r=await i(s(f,`${e.uid}`),{title:t.value,categories:"unknown",author:o.value,description:n.value,pages:a.value,image:l,read:d.checked});t.value="",o.value="",n.value="",a.value=0,d.checked=!1,console.log("Document written with ID: ",r.id)}catch(r){console.error("Error adding document: ",r)}}document.querySelector("#form").addEventListener("submit",(async e=>{e.preventDefault(),await r()}))}(e))}));const h=document.querySelector(".sign-out");document.querySelector(".redirect"),h.addEventListener("click",(()=>{window.location.replace("../index.html"),o(g).then((()=>{console.log("user is sgin out")})).catch((e=>{console.log("something went wrong"),console.log(e.message)}))}));
